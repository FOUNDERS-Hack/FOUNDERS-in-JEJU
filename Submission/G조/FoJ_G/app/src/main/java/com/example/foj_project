package com.example.foj_project
import android.content.Intent
import androidx.appcompat.app.AppCompatActivity
import android.os.Bundle
import kotlinx.android.synthetic.main.activity_sell_.*

class Sell_Activity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_sell_)

        buttontohome.setOnClickListener {
            val intent = Intent(this, Shop1Activity::class.java)
            startActivity(intent)
            finish()
        }
    }
}
package com.example.foj_project

import android.content.Intent
import android.os.Bundle
import android.util.Log
import androidx.appcompat.app.AppCompatActivity
import com.google.android.gms.auth.api.signin.GoogleSignIn
import com.google.android.gms.auth.api.signin.GoogleSignInClient
import com.google.android.gms.auth.api.signin.GoogleSignInOptions
import com.google.firebase.auth.FirebaseAuth
import kotlinx.android.synthetic.main.activity_shop1.*
import com.google.android.material.appbar.CollapsingToolbarLayout
import kotlinx.android.synthetic.main.content_scrolling1.*

class Shop1Activity : AppCompatActivity(){

    //firebase Auth
    private lateinit var firebaseAuth: FirebaseAuth
    //google client
    private lateinit var googleSignInClient: GoogleSignInClient

    val RC_SIGN_IN = 1000


    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_shop1)

        chgview.setOnClickListener {
            val intent = Intent(this, Shop2Activity::class.java)
            startActivity(intent)
            finish()
        }

        Btnbu.setOnClickListener {
            val intent = Intent(this, app2::class.java)
            startActivity(intent)
            finish()
        }
//        하단 네비바
        shop1.setOnClickListener{
            val intent = Intent(this, Shop1Activity::class.java)
            startActivity(intent)
        }

        payment2.setOnClickListener{
            val intent = Intent(this, Payment2Activity::class.java)
            startActivity(intent)
        }

        sell3.setOnClickListener {
            val intent = Intent(this, Sell_Activity::class.java)
            startActivity(intent)
        }

        mypage4.setOnClickListener{
            val intent = Intent(this, personalActivity::class.java)
            startActivity(intent)
        }

        donation5.setOnClickListener{
            val intent = Intent(this, DonationActivity::class.java)
            startActivity(intent)
        }

        val gso = GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)
            .requestIdToken(getString(R.string.default_web_client_id))
            .requestEmail()
            .build()

        googleSignInClient = GoogleSignIn.getClient(this, gso)

        //firebase auth 객체
        firebaseAuth = FirebaseAuth.getInstance()
    }

    override fun onStart() {
        super.onStart()
        Log.d("life_cycle", "onStart")
    }
    override fun onResume() {
        super.onResume()
        Log.d("life_cycle", "onResume")
    }
    override fun onPause() {
        super.onPause()
        Log.d("life_cycle", "onPause")
    }
    override fun onStop() {
        super.onStop()
        Log.d("life_cycle", "onStop")
    }
    override fun onDestroy() {
        super.onDestroy()
        Log.d("life_cycle", "onDestroy")
    }

}

package com.example.foj_project

import android.content.Intent
import android.os.Bundle
import android.util.Log
import androidx.appcompat.app.AppCompatActivity
import com.google.android.gms.auth.api.signin.GoogleSignIn
import com.google.android.gms.auth.api.signin.GoogleSignInClient
import com.google.android.gms.auth.api.signin.GoogleSignInOptions
import com.google.firebase.auth.FirebaseAuth
import kotlinx.android.synthetic.main.activity_shop2.*
import com.google.android.material.appbar.CollapsingToolbarLayout
import kotlinx.android.synthetic.main.content_scrolling1_2.*
import kotlinx.android.synthetic.main.content_scrolling1_2.chgview

class Shop2Activity : AppCompatActivity(){

    //firebase Auth
    private lateinit var firebaseAuth: FirebaseAuth
    //google client
    private lateinit var googleSignInClient: GoogleSignInClient

    val RC_SIGN_IN = 1000


    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_shop2)


        chgview.setOnClickListener {
            val intent = Intent(this, Shop1Activity::class.java)
            startActivity(intent)
        }

        Btnbu.setOnClickListener {
            val intent = Intent(this, app2::class.java)
            startActivity(intent)
            finish()
        }


//        하단 네비바
        shop1.setOnClickListener{
            val intent = Intent(this, Shop2Activity::class.java)
            startActivity(intent)

        }
        payment2.setOnClickListener{
            val intent = Intent(this, Payment2Activity::class.java)
            startActivity(intent)

        }
        sell3.setOnClickListener {
            val intent = Intent(this, Sell_Activity::class.java)
            startActivity(intent)

        }
        mypage4.setOnClickListener{
            val intent = Intent(this, personalActivity::class.java)
            startActivity(intent)

        }

        val gso = GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)
            .requestIdToken(getString(R.string.default_web_client_id))
            .requestEmail()
            .build()

        googleSignInClient = GoogleSignIn.getClient(this, gso)

        //firebase auth 객체
        firebaseAuth = FirebaseAuth.getInstance()
    }

    override fun onStart() {
        super.onStart()
        Log.d("life_cycle", "onStart")
    }
    override fun onResume() {
        super.onResume()
        Log.d("life_cycle", "onResume")
    }
    override fun onPause() {
        super.onPause()
        Log.d("life_cycle", "onPause")
    }
    override fun onStop() {
        super.onStop()
        Log.d("life_cycle", "onStop")
    }
    override fun onDestroy() {
        super.onDestroy()
        Log.d("life_cycle", "onDestroy")
    }

}

package com.example.foj_project

import android.content.Intent
import androidx.appcompat.app.AppCompatActivity
import android.os.Bundle
import kotlinx.android.synthetic.main.activity_app2.*
import kotlinx.android.synthetic.main.activity_verify1.*

class verify1 : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_verify1)

        agree.setOnClickListener(){
            val intent = Intent(this, Payment2Activity::class.java)
            startActivity(intent)
        }
        disagree.setOnClickListener(){
            val intent = Intent(this, Payment2Activity::class.java)
            startActivity(intent)
        }

    }
}
package com.example.foj_project

import android.content.Intent
import androidx.appcompat.app.AppCompatActivity
import android.os.Bundle
import android.view.View
import android.widget.Button
import kotlinx.android.synthetic.*
import kotlinx.android.synthetic.main.activity_app2.*
import kotlinx.android.synthetic.main.activity_verify1.*

class app2 : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_app2);

        Btnask.setOnClickListener(){
            val intent = Intent(this, message2::class.java)
            startActivity(intent)
        }

        btnbuy.setOnClickListener(){
            val intent = Intent(this, buy::class.java)
            startActivity(intent)
        }



    }
}
package com.example.foj_project

import android.content.Intent
import androidx.appcompat.app.AppCompatActivity
import android.os.Bundle
import kotlinx.android.synthetic.main.activity_buy.*
import kotlinx.android.synthetic.main.activity_buy_final.*

class buy : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_buy)

        btnb.setOnClickListener() {
            val intent = Intent(this, buy_final::class.java)
            startActivity(intent)
        }
    }
}
package com.example.foj_project

import android.content.Intent
import androidx.appcompat.app.AppCompatActivity
import android.os.Bundle
import kotlinx.android.synthetic.main.activity_app2.*
import kotlinx.android.synthetic.main.activity_buy_final.*

class buy_final : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_buy_final)

        btnfinish.setOnClickListener() {
            val intent = Intent(this, Shop2Activity::class.java)
            startActivity(intent)
        }
    }
}
package com.example.foj_project

import android.content.Intent
import androidx.appcompat.app.AppCompatActivity
import android.os.Bundle
import kotlinx.android.synthetic.main.activity_complete_donation.*

class CompleteDonationActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_complete_donation)

        tomainbtn_donation.setOnClickListener(){
            val intent = Intent(this, MainActivity::class.java)
            startActivity(intent)
        }

        //        하단 네비바
        shop1.setOnClickListener{
            val intent = Intent(this, Shop1Activity::class.java)
            startActivity(intent)
        }

        payment2.setOnClickListener{
            val intent = Intent(this, Payment2Activity::class.java)
            startActivity(intent)
        }

        sell3.setOnClickListener {
            val intent = Intent(this, Sell_Activity::class.java)
            startActivity(intent)
        }

        mypage4.setOnClickListener{
            val intent = Intent(this, personalActivity::class.java)
            startActivity(intent)
        }

        donation5.setOnClickListener{
            val intent = Intent(this, DonationActivity::class.java)
            startActivity(intent)
        }
    }
}
package com.example.foj_project

import android.content.Intent
import androidx.appcompat.app.AppCompatActivity
import android.os.Bundle
import kotlinx.android.synthetic.main.activity_donation.*

class DonationActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_donation)

        button3.setOnClickListener{
            val intent = Intent(this, CompleteDonationActivity::class.java)
            startActivity(intent)
        }

        //        하단 네비바
        shop1.setOnClickListener{
            val intent = Intent(this, Shop1Activity::class.java)
            startActivity(intent)
        }

        payment2.setOnClickListener{
            val intent = Intent(this, Payment2Activity::class.java)
            startActivity(intent)
        }

        sell3.setOnClickListener {
            val intent = Intent(this, Sell_Activity::class.java)
            startActivity(intent)
        }

        mypage4.setOnClickListener{
            val intent = Intent(this, personalActivity::class.java)
            startActivity(intent)
        }

        donation5.setOnClickListener{
            val intent = Intent(this, DonationActivity::class.java)
            startActivity(intent)
        }
    }
}
package com.example.foj_project

import android.content.Intent
import android.os.Bundle
import android.util.Log
import android.view.View
import androidx.appcompat.app.AppCompatActivity
import com.example.foj_project.login.EmailLoginActivity
import com.google.android.gms.auth.api.signin.GoogleSignIn
import com.google.android.gms.auth.api.signin.GoogleSignInAccount
import com.google.android.gms.auth.api.signin.GoogleSignInClient
import com.google.android.gms.auth.api.signin.GoogleSignInOptions
import com.google.android.gms.common.api.ApiException
import com.google.android.material.snackbar.Snackbar
import com.google.firebase.auth.FirebaseAuth
import com.google.firebase.auth.FirebaseUser
import com.google.firebase.auth.GoogleAuthProvider
import kotlinx.android.synthetic.main.activity_main.*

class MainActivity : AppCompatActivity(), View.OnClickListener {

    //firebase Auth
    private lateinit var firebaseAuth: FirebaseAuth
    //google client
    private lateinit var googleSignInClient: GoogleSignInClient

    //private const val TAG = "GoogleActivity"
    private val RC_SIGN_IN = 99

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        //btn_googleSignIn.setOnClickListener (this) // 구글 로그인 버튼
        btn_google.setOnClickListener { signIn() }
        btn_email.setOnClickListener{
            val intent = Intent(this, EmailLoginActivity::class.java) // 이메일 로그인 화면으로 이동
            startActivity(intent)
        }

        //Google 로그인 옵션 구성. requestIdToken 및 Email 요청
        val gso = GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)
            .requestIdToken(getString(R.string.default_web_client_id))
            .requestEmail()
            .build()

        googleSignInClient = GoogleSignIn.getClient(this, gso)

        //firebase auth 객체
        firebaseAuth = FirebaseAuth.getInstance()
    }

    // onStart. 유저가 앱에 이미 구글 로그인을 했는지 확인
    public override fun onStart() {
        super.onStart()
        val account = GoogleSignIn.getLastSignedInAccount(this)
        if(account!==null){ // 이미 로그인 되어있을시 바로 Shop1Activity로 이동
            toShop1Activity(firebaseAuth.currentUser)
        }
    } //onStart End

    // onActivityResult
    public override fun onActivityResult(requestCode: Int, resultCode: Int, data: Intent?) {
        super.onActivityResult(requestCode, resultCode, data)

        // Result returned from launching the Intent from GoogleSignInApi.getSignInIntent(...);
        if (requestCode == RC_SIGN_IN) {
            val task = GoogleSignIn.getSignedInAccountFromIntent(data)
            try {
                // Google Sign In was successful, authenticate with Firebase
                val account = task.getResult(ApiException::class.java)
                firebaseAuthWithGoogle(account!!)

            } catch (e: ApiException) {
                // Google Sign In failed, update UI appropriately
                Log.w("MainActivity", "Google sign in failed", e)
            }
        }
    } // onActivityResult End

    // firebaseAuthWithGoogle
    private fun firebaseAuthWithGoogle(acct: GoogleSignInAccount) {
        Log.d("MainActivity", "firebaseAuthWithGoogle:" + acct.id!!)

        //Google SignInAccount 객체에서 ID 토큰을 가져와서 Firebase Auth로 교환하고 Firebase에 인증
        val credential = GoogleAuthProvider.getCredential(acct.idToken, null)
        firebaseAuth.signInWithCredential(credential)
            .addOnCompleteListener(this) { task ->
                if (task.isSuccessful) {
                    Log.w("MainActivity", "firebaseAuthWithGoogle 성공", task.exception)
                    toShop1Activity(firebaseAuth.currentUser)
                } else {
                    Log.w("MainActivity", "firebaseAuthWithGoogle 실패", task.exception)
                    Snackbar.make(mainlayout, "로그인에 실패하였습니다.", Snackbar.LENGTH_SHORT).show()
                }
            }
    }// firebaseAuthWithGoogle END


    // toShop1Activity
    fun toShop1Activity(user: FirebaseUser?) {
        if(user !=null) { // AuthMainActivity 로 이동
            startActivity(Intent(this, Shop1Activity::class.java))
            finish()
        }
    } // toShop1Activity End

    // signIn
    private fun signIn() {
        val signInIntent = googleSignInClient.signInIntent
        startActivityForResult(signInIntent, RC_SIGN_IN)
    }
    // signIn End

    override fun onClick(p0: View?) {
    }
}
package com.example.foj_project

import android.content.Context
import android.os.Bundle
import android.view.inputmethod.InputMethodManager
import androidx.appcompat.app.AppCompatActivity
import kotlinx.android.synthetic.main.activity_message2.*


class message2 : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_message2)
        var counter = 0

        fun hideKeyboard() {
            val imm = getSystemService(Context.INPUT_METHOD_SERVICE) as InputMethodManager
            imm.hideSoftInputFromWindow(edit_simple.windowToken, 0)
        }

        btnsend.setOnClickListener {
            hideKeyboard()
            counter++
            if (counter == 1) {
                chat10.setImageResource(R.drawable.chat6)
            } else if (counter == 2) {
                chat9.setImageResource(R.drawable.chat7)
            } else if (counter == 3) {
                chat7.setImageResource(R.drawable.chat8)
            }

        }
    }

}

package com.example.foj_project

import android.content.Intent
import android.os.Bundle
import com.google.android.material.appbar.CollapsingToolbarLayout
import androidx.appcompat.app.AppCompatActivity
import kotlinx.android.synthetic.main.activity_payment2.*
import kotlinx.android.synthetic.main.content_scrolling2.*

class Payment2Activity : AppCompatActivity() {

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_payment2)

        sweet.setOnClickListener {
            val intent = Intent(this, verify1::class.java)
            startActivity(intent)
        }
//        하단 네비바
            shop1.setOnClickListener{
                val intent = Intent(this, Shop1Activity::class.java)
                startActivity(intent)
            }

            payment2.setOnClickListener{
                val intent = Intent(this, Payment2Activity::class.java)
                startActivity(intent)
            }

            sell3.setOnClickListener {
                val intent = Intent(this, Sell_Activity::class.java)
                startActivity(intent)
            }

            mypage4.setOnClickListener{
                val intent = Intent(this, personalActivity::class.java)
                startActivity(intent)
            }

            donation5.setOnClickListener{
                val intent = Intent(this, DonationActivity::class.java)
                startActivity(intent)
            }

    }
}
package com.example.foj_project

import android.content.Intent
import androidx.appcompat.app.AppCompatActivity
import android.os.Bundle
import kotlinx.android.synthetic.main.activity_personal.*

class personalActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_personal)

        //        하단 네비바
        shop1.setOnClickListener{
            val intent = Intent(this, Shop1Activity::class.java)
            startActivity(intent)
        }

        payment2.setOnClickListener{
            val intent = Intent(this, Payment2Activity::class.java)
            startActivity(intent)
        }

        sell3.setOnClickListener {
            val intent = Intent(this, Sell_Activity::class.java)
            startActivity(intent)
        }

        mypage4.setOnClickListener{
            val intent = Intent(this, personalActivity::class.java)
            startActivity(intent)
        }

        donation5.setOnClickListener{
            val intent = Intent(this, DonationActivity::class.java)
            startActivity(intent)
        }
    }
}
